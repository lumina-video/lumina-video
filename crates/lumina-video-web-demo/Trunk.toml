[build]
target = "index.html"
dist = "dist"

[watch]
ignore = ["dist"]

# Bundle @moq/lite into IIFE (window.MoqLite) before build
# Run `npm install` first if node_modules doesn't exist
# Output goes to local moq-lite-bundle.js (copied to dist by data-trunk copy-file in HTML)
[[hooks]]
stage = "pre_build"
command = "sh"
command_args = ["-c", "[ -d node_modules ] || npm install; node esbuild-moq.mjs"]
